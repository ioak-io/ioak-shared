_format_version: "3.0"
_transform: true

services:
  - name: auth-service
    url: http://auth-service:2000
    routes:
      - name: auth-route
        paths:
          - /auth
        strip_path: true

  - name: sparkles-team-service
    url: http://host.docker.internal:2011
    routes:
      - name: sparkles-team-route
        paths:
          - /sparkles/team
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: azp
          claims_to_verify:
            - exp

  # - name: example-express
  #   url: http://host.docker.internal:2010
  #   routes:
  #     - name: express-route
  #       paths:
  #         - /express
  #       strip_path: true
  #   plugins:
  #     - name: jwt
  #       config:
  #         key_claim_name: azp
  #         claims_to_verify:
  #           - exp

  # - name: example-fastapi
  #   url: http://example-fastapi:3010
  #   routes:
  #     - name: fastapi-route
  #       paths:
  #         - /fastapi
  #       strip_path: true
  #   plugins:
  #     - name: jwt
  #       config:
  #         key_claim_name: azp
  #         claims_to_verify:
  #           - exp

consumers:
  - username: jwt-for-sparkles

jwt_secrets:
  - consumer: jwt-for-sparkles
    key: sparkles # must match `azp` in token
    algorithm: RS256
    rsa_public_key: |
      -----BEGIN PUBLIC KEY-----
      MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuBQhWnxud843fqNrPI5M
      AO3yqKtCOh6Gc2bp/EDLe2Wyza7C5xE9EjrrzpTy+LapyfwnTsUaiaDFOCIxla7N
      ydRm/crMr03FclIPB0E4VPm89xJGJCWRLh2MTn/ecFNSnFRHiaOke2AVYPKXQBml
      b/DSpkggQXWxVgOCrxJRjnme/LFuBZqv7raKpg/DZsIspZsATySwwj7QLdqnWSRY
      vacouEJB0xNq2Ugu8AbA+X46uYF4064MpmbXkewHW0rFhct69RQCG2iWy8M3F+C/
      1f9/km4s22u2hLn8jx1Qv+UmwQxWA4K1DkiZ3uJoknRPUNtH+5OMROp4eajaP0zr
      qwIDAQAB
      -----END PUBLIC KEY-----
